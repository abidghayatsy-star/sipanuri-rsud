================================================================
   SIPANURI - BACKUP DATA KE GOOGLE SHEET
   Sistem Pemantauan Paviliun Nuri
   RSUD Aji Muhammad Parikesit
================================================================

ğŸ“ FILE YANG DISEDIAKAN:
------------------------
1. code.gs    â†’ Copy-paste ke Google Apps Script

================================================================
   CARA PENGGUNAAN (STEP BY STEP)
================================================================

LANGKAH 1: Buka Google Sheets
-----------------------------
- Buka https://sheets.google.com
- Klik "+ Blank" atau buat spreadsheet baru


LANGKAH 2: Buka Apps Script
---------------------------
- Di spreadsheet, klik menu: Extensions â†’ Apps Script
- Tab baru akan terbuka dengan editor kode


LANGKAH 3: Copy-Paste Kode
--------------------------
- HAPUS SEMUA KODE yang ada di editor
- Buka file "code.gs" di folder ini
- Copy SELURUH isi file
- Paste ke editor Apps Script


LANGKAH 4: Simpan
-----------------
- Klik File â†’ Save (atau tekan Ctrl+S)
- Beri nama project: "SIPANURI Backup"
- Klik OK


LANGKAH 5: Jalankan Setup
-------------------------
- Di dropdown fungsi (pojok kanan atas), pilih: "setupSpreadsheet"
- Klik tombol â–¶ Run
- Klik "Review Permissions"
- Pilih akun Google Anda
- Klik "Advanced" â†’ "Go to SIPANURI Backup (unsafe)" â†’ "Allow"


LANGKAH 6: Sync Data
--------------------
- Pilih fungsi: "syncAllData"
- Klik â–¶ Run
- Data akan dimuat (sample data karena API localhost)


LANGKAH 7: Selesai!
-------------------
- Kembali ke spreadsheet
- Menu "ğŸ”„ SIPANURI" akan muncul di menu bar

================================================================
   SETELAH APLIKASI DI-DEPLOY KE PRODUCTION
================================================================

1. Deploy aplikasi Next.js ke Vercel/server

2. Di Apps Script, ganti baris:
   const API_URL = 'http://localhost:3000/api/sipanuri/export'
   
   Menjadi:
   const API_URL = 'https://domain-anda.com/api/sipanuri/export'

3. Simpan dan jalankan "syncAllData" lagi

================================================================
   MENU YANG TERSEDIA
================================================================

Di Google Sheets akan muncul menu "ğŸ”„ SIPANURI":

ğŸ“Š Setup Spreadsheet  â†’ Setup awal (jalankan sekali)
ğŸ”„ Sync Data          â†’ Sinkronisasi data dari API
ğŸ§ª Test Koneksi API   â†’ Cek koneksi ke API
ğŸ“„ Export ke PDF      â†’ Export ke file PDF
ğŸ“ Backup ke JSON     â†’ Backup ke file JSON

================================================================
   SHEET YANG DIBUAT
================================================================

1. Dashboard        â†’ Ringkasan statistik
2. Data Kamar       â†’ 20 kamar (VVIP & VIP)
3. Riwayat Pasien   â†’ History pasien masuk/keluar
4. Data Dokter      â†’ Daftar dokter
5. BHP ATK          â†’ Inventaris & stok
6. Riwayat Stok     â†’ History stok masuk/keluar
7. Data Aset        â†’ Daftar aset paviliun
8. Peminjaman Aset  â†’ Data peminjaman

================================================================
   BACKUP OTOMATIS (TRIGGER)
================================================================

Untuk backup otomatis setiap hari:

1. Di Apps Script, jalankan fungsi "createDailyTrigger"
2. Data akan di-sync otomatis setiap hari jam 23:00

Untuk menghentikan:
- Jalankan fungsi "removeTriggers"

================================================================
   TROUBLESHOOTING
================================================================

âŒ Error: "UrlFetchApp failed"
   â†’ API URL tidak bisa diakses (localhost tidak bisa dari Google)
   â†’ Deploy aplikasi dulu ke production

âŒ Error: "Authorization required"
   â†’ Klik "Review Permissions" â†’ Allow

âŒ Data tidak muncul
   â†’ Cek API_URL sudah benar
   â†’ Jalankan "testApiConnection"
   â†’ Cek log: View â†’ Logs

================================================================

Selamat beristirahat! ğŸŒ™
Data Anda aman dengan sistem backup ini.

================================================================
